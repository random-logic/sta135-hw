# 1
### (a)
We will use the Hotelling $T^2$ Statistic because we have a two-sample multivariate hypothesis test. The formula is:
$$
T^2 = \frac{n_1 n_2}{n_1 + n_2} (\bar{x}_1 - \bar{x}_2)^T S_p^{-1} (\bar{x}_1 - \bar{x}_2)
$$
$$
S_p = \frac{(n_1 - 1)S_1 + (n_2 - 1)S_2}{n_1 + n_2 - 2}
$$

Where:

- $\bar{x}_1$, $\bar{x}_2$ are the sample mean vectors of the two groups
- $n_1$, $n_2$ are the sample sizes of each group
- $S_p$ is the pooled sample covariance matrix

Our critical value is:

$$
\frac{(n_1 + n_2 - p - 1)p}{(n_1 + n_2 - 2)p} T^2 \sim F_{p, n_1 + n_2 - p - 1}
$$

Where:

- $p$ is the number of variables (dimensions)
- $F_{p, n_1 + n_2 - p - 1}$ is the F-distribution with degrees of freedom $p$ and $n_1 + n_2 - p - 1$
  - This can be computed in R using the `qf` function

### (b)
```{r}
library(MASS)
library(Hotelling)
```

```{r}
# Haltica oleracea
species1 <- matrix(c(
  189, 245, 137, 163,
  192, 260, 132, 217,
  217, 276, 141, 192,
  221, 299, 142, 213,
  171, 239, 128, 158,
  192, 262, 147, 173,
  213, 278, 136, 201,
  192, 255, 128, 185,
  170, 244, 128, 192,
  201, 276, 146, 186,
  195, 242, 128, 192,
  205, 263, 147, 192,
  180, 252, 121, 167,
  192, 283, 138, 183,
  200, 294, 138, 188,
  192, 277, 150, 177,
  200, 287, 136, 173,
  181, 255, 146, 183,
  192, 287, 141, 198
), ncol = 4, byrow = TRUE)

# Haltica carduorum
species2 <- matrix(c(
  181, 305, 184, 209,
  158, 237, 133, 188,
  184, 300, 166, 231,
  171, 273, 162, 213,
  181, 297, 163, 224,
  181, 308, 160, 223,
  177, 301, 166, 221,
  198, 308, 141, 197,
  180, 286, 146, 214,
  177, 299, 171, 192,
  176, 317, 166, 213,
  192, 312, 166, 209,
  176, 285, 141, 200,
  169, 287, 162, 214,
  164, 265, 147, 192,
  181, 308, 157, 204,
  192, 276, 154, 209,
  181, 278, 149, 235,
  175, 271, 140, 192,
  197, 303, 170, 205
), ncol = 4, byrow = TRUE)

# Convert matrices to data frames
df_species1 <- as.data.frame(species1)
df_species2 <- as.data.frame(species2)
colnames(df_species1) <- c("y1", "y2", "y3", "y4")
colnames(df_species2) <- c("y1", "y2", "y3", "y4")

# Do test
alpha <- 0.05
result <- hotelling.test(df_species1, df_species2)
```

Our $T^2$ statistic is $`r round(result$stats$statistic, 4)`$ and our p-value is $`r formatC(result$pval, format = "e", digits = 4)`$.

### (c)
Since our p-value is `r if (result$pval < alpha) "less than" else "equal to or greater than"` $\alpha$, we `r if (result$pval < alpha) "reject" else "accept"` $H_0$.

# 2
### (a)
TODO: wait for Tuesday's discussion to finish this so we can cross check if we used the right formula

We will the likelihood ratio test (LRT) to test whether the covariance matrix of a bivariate dataset is equal to a given matrix. The formula is:

$$
\Lambda = \left( \frac{|\Sigma_0|}{|S|} \right)^{n/2} \exp\left( -\frac{n}{2} \left[ \text{tr}(\Sigma_0^{-1}S) - p \right] \right)
$$

This is commonly transformed into a chi-square approximation for practical use:

$$
-2 \ln \Lambda \sim \chi^2_{\frac{1}{2}p(p+1)} \quad \text{under } H_0
$$

Where:

- $\Sigma_0$ is the hypothesized covariance matrix
- $S$ is the sample covariance matrix
- $n$ is the sample size
- $p = 2$ is the dimension

### (b)
```{r}
# Height and Weight Data
data <- matrix(c(
  69, 153,
  74, 175,
  68, 155,
  70, 135,
  72, 172,
  67, 150,
  66, 115,
  70, 137,
  76, 200,
  68, 130,
  72, 140,
  79, 265,
  74, 185,
  67, 112,
  66, 140,
  71, 150,
  74, 165,
  75, 185,
  75, 210,
  76, 220
), ncol = 2, byrow = TRUE)

# Convert matrices to data frames
df <- as.data.frame(data)
colnames(df) <- c("x", "y")
df
```

# 3
TODO