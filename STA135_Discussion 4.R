# Discussion 4

# 1.
data1 <- t(matrix(c(189,245,137,163,
192,260,132,217,
217,276,141,192,
221,299,142,213,
171,239,128,158,
192,262,147,173,
213,278,136,201,
192,255,128,185,
170,244,128,192,
201,276,146,186,
195,242,128,192,
205,263,147,192,
180,252,121,167,
192,283,138,183,
200,294,138,188,
192,277,150,177,
200,287,136,173,
181,255,146,183,
192,287,141,198),4,19))
data2 <- t(matrix(c(181,305,184,209,
158,237,133,188,
184,300,166,231,
171,273,162,213,
181,297,163,224,
181,308,160,223,
177,301,166,221,
198,308,141,197,
180,286,146,214,
177,299,171,192,
176,317,166,213,
192,312,166,209,
176,285,141,200,
169,287,162,214,
164,265,147,192,
181,308,157,204,
192,276,154,209,
181,278,149,235,
175,271,140,192,
197,303,170,205),4,20))
data1
data2

ybar1 <- apply(data1,2,mean)
ybar2 <- apply(data2,2,mean)

S1 <- cov(data1)
S2 <- cov(data2)

n1 <- dim(data1)[1]
n2 <- dim(data2)[1]
p <- dim(data1)[2] #p <- dim(data2)[2]
Sp <- ((n1-1)*S1+(n2-1)*S2)/(n1+n2-2)

T2 <- (ybar1-ybar2) %*% solve(Sp/n1+Sp/n2) %*% (ybar1-ybar2)
# degrees of freedom: p,n1+n2-2
# F: p,n1+n2-p-1
T2
qf(0.95,p,n1+n2-p-1)
qf(0.95,p,n1+n2-p-1)*p*(n1+n2-2)/(n1+n2-p-1)
# T2 > quantile
# reject null hypothesis


# 2.
mydata <- t(matrix(c(
148,20,137,15,
159,24,164,25,
144,19,224,27,
103,18,208,33,
121,17,178,24,
89,11,128,20,
119,17,154,18,
123,13,158,16,
76,16,102,21,
217,29,214,25,
148,22,209,24,
151,21,151,16,
83,7,123,13,
135,20,161,22,
178,15,175,23),4,15))
mydata
mydata <- cbind(mydata,mydata[,1]-mydata[,3],mydata[,2]-mydata[,4])
mydata
d_data <- mydata[,5:6] # make sure you understand these notations

dbar <- apply(d_data,2,mean)
Sd <- cov(d_data)
n <- dim(d_data)[1]
p <- dim(d_data)[2]

T2 <- n*dbar %*% solve(Sd) %*% dbar
T2

qf(0.95,p,n-p)
qf(0.95,p,n-p)*p*(n-1)/(n-p)
# T2 > quantile
# reject null hypothesis